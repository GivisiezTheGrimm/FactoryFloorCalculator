#include <stdio.h>
#include "platform.h"
#include "xparameters.h" // add
#include "xiomodule.h" // add

//inicializando outras funções:

int numdisp(u32 data, XIOModule gpo);

int main() {
init_platform();

	u32 C, D;
	unsigned char data, btn, A,B,X;

	XIOModule gpi;
	XIOModule gpo;

	XIOModule_Initialize(&gpi, XPAR_IOMODULE_0_DEVICE_ID);
	XIOModule_Start(&gpi);
	XIOModule_Initialize(&gpo, XPAR_IOMODULE_0_DEVICE_ID);
	XIOModule_Start(&gpo);

	while(1){

		data = XIOModule_DiscreteRead(&gpi, 1); // read switches (channel 1)
		btn = XIOModule_DiscreteRead(&gpi, 2); // read buttons (channel 2)
		if(data<=128){
			A=data;
			X=A;
		}else{
			B = data-128;
			X=B;
		}

	if(A>=B)
		C=A-B;
	else
		C=B-A;

	if(B<=0)
		D=14000;
	else
		D=A/B;

	switch(btn){
		case 0b0001:
			X=A+B;
		break;
		case 0b0010:
			X=C;
		break;
		case 0b0100:
			X=A*B;
		break;
		case 0b1000:
			X=D;
		break;
	}//end switch
	numdisp(X, gpo);

	//	XIOModule_DiscreteWrite(&gpo, 1, data);
	} //end while(1)

	cleanup_platform();

return 0;
}
